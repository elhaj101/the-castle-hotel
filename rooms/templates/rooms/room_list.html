{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="py-8 md:py-12 px-4 md:px-10 lg:px-20 bg-background-light min-h-screen">
  <div class="max-w-[1400px] mx-auto flex flex-col gap-8">

    <!-- Header -->
    <div class="flex flex-col items-center gap-3 text-center">
      <span class="text-primary font-bold tracking-wider uppercase text-sm">Accommodations</span>
      <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-[#111318] tracking-tight">Choose Your Perfect Room</h1>
      <p class="text-gray-600 text-base md:text-lg max-w-[600px]">Select your dates and explore our variety of booking
        options</p>
      <div class="h-1 w-20 bg-primary rounded-full mt-2"></div>
    </div>

    <!-- Date Pickers -->
    <div
      class="flex flex-col sm:flex-row justify-center items-center gap-4 bg-white p-6 rounded-xl shadow-sm max-w-[600px] mx-auto w-full">
      <div class="flex-1 w-full">
        <label class="block text-sm font-semibold text-gray-700 mb-2">Check-in Date</label>
        <input type="date" id="main_check_in_date"
          class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all"
          required min="{{ today }}">
      </div>
      <div class="flex-1 w-full">
        <label class="block text-sm font-semibold text-gray-700 mb-2">Check-out Date</label>
        <input type="date" id="main_check_out_date"
          class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all"
          required min="{{ today }}">
      </div>
    </div>

    {% if user.is_authenticated %}
    <div class="text-center">
      <a href="{% url 'reservation_list' %}"
        class="inline-flex items-center gap-2 text-primary hover:text-blue-700 font-semibold transition-colors">
        <span class="material-symbols-outlined text-xl">calendar_month</span>
        View my reservations
      </a>
    </div>
    {% else %}
    <div class="text-center">
      <a href="{% url 'login' %}"
        class="inline-flex items-center gap-2 text-primary hover:text-blue-700 font-semibold transition-colors">
        <span class="material-symbols-outlined text-xl">login</span>
        Log in to manage reservations
      </a>
    </div>
    {% endif %}

    <!-- Room Cards Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">

      <!-- Double Room Card -->
      <div
        class="group bg-white rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden flex flex-col">
        <div class="relative h-64 overflow-hidden">
          <img src="{% static 'media/room4.jpg' %}" alt="Double Room"
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
          <div class="absolute top-4 right-4 bg-primary text-white px-4 py-2 rounded-full text-sm font-bold shadow-lg">
            ${{ double_room.price_per_night|default:"N/A" }}/night
          </div>
        </div>
        <div class="p-6 flex flex-col flex-1">
          <h3 class="text-2xl font-bold text-[#111318] mb-3">Double Room</h3>
          <p class="text-gray-600 mb-6 flex-1">Spacious room perfect for couples with modern amenities and comfortable
            bedding.</p>
          <button
            class="w-full bg-primary hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200 book-room-btn"
            data-room-type="Double Room" data-room-price="{{ double_room.price_per_night|default:'' }}" type="button">
            Book Now
          </button>
        </div>
      </div>

      <!-- Single Room Card -->
      <div
        class="group bg-white rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden flex flex-col">
        <div class="relative h-64 overflow-hidden">
          <img src="{% static 'media/singleroom.jpg' %}" alt="Single Room"
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
          <div class="absolute top-4 right-4 bg-primary text-white px-4 py-2 rounded-full text-sm font-bold shadow-lg">
            ${{ single_room.price_per_night|default:"N/A" }}/night
          </div>
        </div>
        <div class="p-6 flex flex-col flex-1">
          <h3 class="text-2xl font-bold text-[#111318] mb-3">Single Room</h3>
          <p class="text-gray-600 mb-6 flex-1">Cozy and comfortable room ideal for solo travelers seeking quality rest.
          </p>
          <button
            class="w-full bg-primary hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200 book-room-btn"
            data-room-type="Single Room" data-room-price="{{ single_room.price_per_night|default:'' }}" type="button">
            Book Now
          </button>
        </div>
      </div>

      <!-- Suite Card -->
      <div
        class="group bg-white rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden flex flex-col md:col-span-2 lg:col-span-1">
        <div class="relative h-64 overflow-hidden">
          <img src="{% static 'media/room1.jpg' %}" alt="Suite"
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
          <div class="absolute top-4 right-4 bg-primary text-white px-4 py-2 rounded-full text-sm font-bold shadow-lg">
            ${{ suite.price_per_night|default:"N/A" }}/night
          </div>
          <div class="absolute top-4 left-4 bg-yellow-500 text-white px-3 py-1 rounded-full text-xs font-bold">
            PREMIUM
          </div>
        </div>
        <div class="p-6 flex flex-col flex-1">
          <h3 class="text-2xl font-bold text-[#111318] mb-3">Suite</h3>
          <p class="text-gray-600 mb-6 flex-1">Luxurious suite with separate living area, premium amenities, and
            stunning views.</p>
          <button
            class="w-full bg-primary hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200 book-room-btn"
            data-room-type="Suite" data-room-price="{{ suite.price_per_night|default:'' }}" type="button">
            Book Now
          </button>
        </div>
      </div>
    </div>

    <!-- Comments Section -->
    <div class="bg-white shadow-md rounded-2xl p-6 md:p-8 mt-8">
      <div class="flex items-center gap-3 mb-6">
        <span class="material-symbols-outlined text-primary text-3xl">chat</span>
        <h2 class="text-2xl md:text-3xl font-bold text-[#111318]">Guest Reviews</h2>
      </div>

      <div class="space-y-4 mb-8">
        {% for comment in comments %}
        <div class="border-b border-gray-100 pb-4 last:border-0">
          <div class="flex items-start gap-3">
            <div
              class="bg-primary/10 text-primary w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0">
              <span class="material-symbols-outlined">person</span>
            </div>
            <div class="flex-1">
              <p class="font-semibold text-[#111318]">{{ comment.user }}</p>
              <p class="text-gray-600 mt-1">{{ comment.text }}</p>
              <p class="text-sm text-gray-400 mt-2">{{ comment.created_at|date:"F j, Y, g:i a" }}</p>
            </div>
          </div>
        </div>
        {% empty %}
        <p class="text-gray-500 text-center py-8">No reviews yet. Be the first to share your experience!</p>
        {% endfor %}
      </div>

      {% if user.is_authenticated %}
      <form method="post" action="{% url 'add_comment' 'rooms' %}" class="mt-6">
        {% csrf_token %}
        <label class="block text-sm font-semibold text-gray-700 mb-2">Share your experience</label>
        <textarea name="text" rows="3"
          class="w-full border border-gray-300 rounded-lg p-4 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all"
          placeholder="Write your review here..." required></textarea>
        <button type="submit"
          class="mt-4 bg-primary hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-md hover:shadow-lg">
          Post Review
        </button>
      </form>
      {% else %}
      <p class="text-gray-500 text-center py-4">
        <a href="{% url 'login' %}" class="text-primary hover:underline font-semibold">Log in</a> to share your review
      </p>
      {% endif %}
    </div>
  </div>
</section>

{% include 'rooms/interactive/room_modal_1.html' %}
{% endblock %}